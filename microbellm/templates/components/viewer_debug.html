{% extends "admin_base.html" %}

{% block title %}{{ section.id }} - Debug{% endblock %}

{% block content %}
<div style="padding: 20px;">
    <h1 style="margin-bottom: 20px;">{{ section.id | replace('_', ' ') | title }} - Debug View</h1>

    <!-- Debug Info -->
    <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 30px;">
        <h2 style="margin-top: 0; color: #495057;">Debug Information</h2>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <h3 style="color: #6b7280; margin-bottom: 10px;">Section Properties</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>ID:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ section.id }}</td></tr>
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Type:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ section.type }}</td></tr>
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>File:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ section.file or 'N/A' }}</td></tr>
                    {% if section.title %}<tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Title:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ section.title }}</td></tr>{% endif %}
                    {% if section.text %}<tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Text:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ section.text }}</td></tr>{% endif %}
                </table>
            </div>

            <div>
                <h3 style="color: #6b7280; margin-bottom: 10px;">Page Information</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Page:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ page }}</td></tr>
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Project:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ project.id if project else 'N/A' }}</td></tr>
                    <tr><td style="padding: 4px 8px; border: 1px solid #d1d5db; background: #f9fafb;"><strong>Color Theme:</strong></td><td style="padding: 4px 8px; border: 1px solid #d1d5db;">{{ manifest.page_config.color_theme }}</td></tr>
                </table>
            </div>
        </div>
    </div>

    <!-- Component Content with Boundaries -->
    <div style="border: 2px dashed #ef4444; border-radius: 8px; padding: 20px; margin-bottom: 20px; position: relative;">
        <div style="position: absolute; top: -12px; left: 20px; background: white; padding: 0 8px; color: #ef4444; font-weight: 600;">
            COMPONENT BOUNDARY
        </div>

        {% if section.title %}
            <h2 style="margin-top: 0; color: #374151;">{{ section.title }}</h2>
        {% endif %}

        {% if section.text %}
            <p style="color: #6b7280; margin-bottom: 20px;">{{ section.text }}</p>
        {% endif %}

        <!-- Component Content -->
        {% if section.type == 'section_callout_dynamic' %}
            <section class="section-callout section-callout--{{ manifest.page_config.color_theme or 'purple' }}">
                <div class="section-callout__content">
                    {% if section.title or section.text %}
                    <div class="section-callout__header">
                        {% if section.title %}<h3 class="section-callout__title">{{ section.title }}</h3>{% endif %}
                        {% if section.text %}<p class="section-callout__text">{{ section.text }}</p>{% endif %}
                    </div>
                    {% endif %}
                    {% include 'research/' + page + '/' + section.file %}
                </div>
            </section>
        {% else %}
            {% include 'research/' + page + '/' + section.file %}
        {% endif %}
    </div>

    <!-- Navigation -->
    <div style="margin-top: 30px; text-align: center;">
        <a href="{{ url_for('components_index') }}" style="color: #666; text-decoration: none; margin-right: 20px;">← Back to Components</a>
        <a href="/{{ page }}" style="color: #666; text-decoration: none; margin-right: 20px;">View Full Page →</a>
        <a href="{{ url_for('view_component', page=page, section_id=section.id, simple='true') }}" style="color: #059669; text-decoration: none;">Simple View</a>
    </div>
</div>

{% if section.type in ['section_callout_dynamic'] %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
        if (typeof initModelAccuracy === 'function' && '{{ section.id }}' === 'model_accuracy') {
            initModelAccuracy();
        }
    }, 500);
});
</script>
{% endif %}
{% endblock %}